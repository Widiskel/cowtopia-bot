const a2_0x2d081b=a2_0x37fc;(function(_0x539aba,_0x2950cd){const _0x412bbe=a2_0x37fc,_0x12a93d=_0x539aba();while(!![]){try{const _0x57aa66=-parseInt(_0x412bbe(0xbd))/0x1*(-parseInt(_0x412bbe(0xd4))/0x2)+-parseInt(_0x412bbe(0xd9))/0x3+parseInt(_0x412bbe(0xd3))/0x4+-parseInt(_0x412bbe(0xcb))/0x5*(parseInt(_0x412bbe(0x101))/0x6)+parseInt(_0x412bbe(0xb9))/0x7+parseInt(_0x412bbe(0xbc))/0x8*(parseInt(_0x412bbe(0xf8))/0x9)+-parseInt(_0x412bbe(0xbf))/0xa*(parseInt(_0x412bbe(0xe6))/0xb);if(_0x57aa66===_0x2950cd)break;else _0x12a93d['push'](_0x12a93d['shift']());}catch(_0x32e72f){_0x12a93d['push'](_0x12a93d['shift']());}}}(a2_0x31c4,0x3966a));import{API}from'../api/api.js';import{Helper}from'../utils/helper.js';import a2_0x1f8d07 from'../utils/logger.js';import{io}from'socket.io-client';function a2_0x31c4(){const _0x47a7ad=['success','profit','win_rate','stringify','connect_timeout','win','LOSE','Getting\x20game\x20info...','emit','claimOfflineProfit','1446126cQZUPK','user','delay','Socket\x20ID:\x20','Starting\x20Conquest....','WSS\x20Connection\x20Error:\x20','WSS\x20Error\x20:\x20','money','WSS\x20Connected...','fetch','getMission','Connecting\x20to\x20WSS...','\x20Offline\x20Profit....','game','Successfully\x20Get\x20Game\x20info','\x20Completed\x20Successfully','Failed\x20to\x20Complete\x20Mission\x20','Error\x20Parsing\x20Msg\x20:\x20','1278KwKjqn','/mission?group=main','error','off','Claiming\x20Offline\x20Profit....','/conquest/info?','reduce','disconnect','Enemy\x20With\x20Highest\x20Win\x20Rate\x20','356814okLUza','query','Claiming\x20','user_id','/user/offline-profit?','enemies','getGameInfo','connect','https://cowtopia-be.tonfarmer.com','WIN','...','message','Bearer\x20','plainToken','WSS\x20Handshake\x20completed\x20and\x20connected.','initWss','2240756BRKnZx','missions','attack_fee_money','10824swbjUk','844rXhAqM','data','10PpcfNS','conquest','queryObj','POST','claim-offline','WSS\x20Handshake\x20Timeout','connect_error','missionList','GET','WSS\x20Handshake\x20Error:\x20','wss://cowtopia-ws.tonfarmer.com','cool_down','25NJgKKj','account','push','/mission?group=partner','Receiving\x20WSS\x20Msg\x20:\x20','info','WSS\x20Connection\x20Closed\x20','\x20Money\x20And\x20','475160ftJdmf','290JmzEEH','Successfully\x20Get\x20Misisons','completed','token','/user/game-info?','268437ZQGJTy','socket','Checking\x20Missions\x20'];a2_0x31c4=function(){return _0x47a7ad;};return a2_0x31c4();}function a2_0x37fc(_0x12f086,_0x513e04){const _0x31c41c=a2_0x31c4();return a2_0x37fc=function(_0x37fcfa,_0x3db93c){_0x37fcfa=_0x37fcfa-0xb7;let _0x27872c=_0x31c41c[_0x37fcfa];return _0x27872c;},a2_0x37fc(_0x12f086,_0x513e04);}export class Cowtopia extends API{constructor(_0x5d607c,_0x39009b,_0x1b122b){const _0x423d73=a2_0x37fc;super(_0x39009b,_0x423d73(0x109)),this['account']=_0x5d607c,this[_0x423d73(0x102)]=_0x39009b,this[_0x423d73(0xc1)]=_0x1b122b;}async['login'](){const _0x2e587c=a2_0x37fc;try{await Helper[_0x2e587c(0xe8)](0x1f4,this[_0x2e587c(0xcc)],'Try\x20to\x20Login...',this);const _0x14d929=await this[_0x2e587c(0xef)]('/auth',_0x2e587c(0xc2),undefined,undefined,{'X-Tg-Data':this['query']});await Helper['delay'](0x3e8,this[_0x2e587c(0xcc)],'Successfully\x20Login',this),this['token']=_0x2e587c(0x10d)+_0x14d929['data']['access_token'],this[_0x2e587c(0x10e)]=_0x14d929[_0x2e587c(0xbe)]['access_token'],this[_0x2e587c(0xe7)]=_0x14d929[_0x2e587c(0xbe)]['user'];}catch(_0x3b7fd2){throw _0x3b7fd2;}}async[a2_0x2d081b(0x107)](_0x1015e1=![]){const _0x30e5b1=a2_0x2d081b;try{if(_0x1015e1)await Helper[_0x30e5b1(0xe8)](0x1f4,this[_0x30e5b1(0xcc)],_0x30e5b1(0xe3),this);const _0x35f872=await this[_0x30e5b1(0xef)](_0x30e5b1(0xd8),_0x30e5b1(0xc7),this[_0x30e5b1(0xd7)]);if(_0x1015e1)await Helper[_0x30e5b1(0xe8)](0x1f4,this[_0x30e5b1(0xcc)],_0x30e5b1(0xf4),this);this[_0x30e5b1(0xf3)]=_0x35f872[_0x30e5b1(0xbe)],this[_0x30e5b1(0xe7)]=_0x35f872['data'][_0x30e5b1(0xe7)];}catch(_0x23ea0f){throw _0x23ea0f;}}async[a2_0x2d081b(0xb8)](){return new Promise(async(_0x30475b,_0x1391a4)=>{const _0x49357a=a2_0x37fc;await Helper[_0x49357a(0xe8)](0x3e8,this[_0x49357a(0xcc)],_0x49357a(0xf1),this),this[_0x49357a(0xda)]=io(_0x49357a(0xc9),{'auth':{'token':this[_0x49357a(0x10e)]},'transports':['websocket']}),this[_0x49357a(0xda)]['on'](_0x49357a(0x108),async()=>{const _0x462491=_0x49357a;await Helper[_0x462491(0xe8)](0x3e8,this['account'],_0x462491(0xee),this),a2_0x1f8d07[_0x462491(0xd0)](_0x462491(0xb7)),a2_0x1f8d07['info'](_0x462491(0xe9)+this[_0x462491(0xda)]['id']),_0x30475b();}),this[_0x49357a(0xda)]['on'](_0x49357a(0xc5),async _0x22d766=>{const _0x50f874=_0x49357a;await Helper[_0x50f874(0xe8)](0x3e8,this[_0x50f874(0xcc)],_0x50f874(0xeb)+_0x22d766[_0x50f874(0x10c)],this),a2_0x1f8d07['error'](_0x50f874(0xc8)+_0x22d766[_0x50f874(0x10c)]),_0x1391a4(_0x22d766);}),this[_0x49357a(0xda)]['on'](_0x49357a(0xe0),async()=>{const _0x2b1464=_0x49357a;await Helper[_0x2b1464(0xe8)](0x3e8,this[_0x2b1464(0xcc)],'WSS\x20Connection\x20Timeout',this),a2_0x1f8d07[_0x2b1464(0xfa)]('WSS\x20Handshake\x20Timeout'),_0x1391a4(new Error(_0x2b1464(0xc4)));}),this['socket']['on'](_0x49357a(0xfa),async _0x132788=>{const _0x3244d3=_0x49357a;await Helper[_0x3244d3(0xe8)](0x3e8,this['account'],_0x3244d3(0xec)+_0x132788[_0x3244d3(0x10c)],this),a2_0x1f8d07[_0x3244d3(0xfa)](_0x3244d3(0xec)+_0x132788[_0x3244d3(0x10c)]),_0x1391a4(_0x132788);}),this[_0x49357a(0xda)]['on'](_0x49357a(0xff),async _0x7a5523=>{const _0x26bdd0=_0x49357a;await Helper[_0x26bdd0(0xe8)](0x3e8,this[_0x26bdd0(0xcc)],_0x26bdd0(0xd1)+_0x7a5523+_0x26bdd0(0x10b),this),a2_0x1f8d07[_0x26bdd0(0xd0)]('WSS\x20Disconnected:\x20'+_0x7a5523);});});}async[a2_0x2d081b(0xf0)](){const _0x3f6363=a2_0x2d081b;try{await Helper['delay'](0x1f4,this[_0x3f6363(0xcc)],'Getting\x20Missions...',this),this[_0x3f6363(0xc6)]=[];const _0x51356c=await this['fetch'](_0x3f6363(0xf9),_0x3f6363(0xc7),this[_0x3f6363(0xd7)]);this[_0x3f6363(0xc6)][_0x3f6363(0xcd)](..._0x51356c[_0x3f6363(0xbe)]['missions']);const _0x9cef7d=await this[_0x3f6363(0xef)](_0x3f6363(0xce),_0x3f6363(0xc7),this[_0x3f6363(0xd7)]);this['missionList'][_0x3f6363(0xcd)](..._0x9cef7d[_0x3f6363(0xbe)][_0x3f6363(0xba)]),await Helper[_0x3f6363(0xe8)](0x3e8,this[_0x3f6363(0xcc)],_0x3f6363(0xd5),this);}catch(_0x3aba7d){throw _0x3aba7d;}}async['checkMission'](_0xff983d){return new Promise(async(_0x2de47d,_0x42319c)=>{const _0x47dd4c=a2_0x37fc;try{await Helper[_0x47dd4c(0xe8)](0x1f4,this['account'],_0x47dd4c(0xdb)+_0xff983d+'....',this);const _0x104452='check-mission',_0x2ba6f9={'mission_key':_0xff983d},_0x1ea21f=async _0x36e6b=>{const _0x4860f7=_0x47dd4c;try{a2_0x1f8d07[_0x4860f7(0xd0)](_0x4860f7(0xcf)+JSON['stringify'](_0x36e6b)),_0x36e6b['data'][_0x4860f7(0xd6)]==!![]?await Helper[_0x4860f7(0xe8)](0x7d0,this[_0x4860f7(0xcc)],'Mission\x20'+_0xff983d+_0x4860f7(0xf5),this):await Helper[_0x4860f7(0xe8)](0x3e8,this[_0x4860f7(0xcc)],_0x4860f7(0xf6)+_0xff983d,this),await this[_0x4860f7(0x107)](),await this[_0x4860f7(0xda)][_0x4860f7(0xfb)](_0x104452,await _0x1ea21f),_0x2de47d();}catch(_0x2d6bf9){a2_0x1f8d07[_0x4860f7(0xfa)](_0x4860f7(0xf7)+_0x2d6bf9[_0x4860f7(0x10c)]),_0x42319c(new Error(_0x4860f7(0xf7)+_0x2d6bf9[_0x4860f7(0x10c)]));}};await this[_0x47dd4c(0xda)][_0x47dd4c(0xe4)](_0x104452,_0x2ba6f9),await this['socket']['on'](_0x104452,_0x1ea21f);}catch(_0xd81de3){throw _0xd81de3;}});}async[a2_0x2d081b(0xe5)](){return new Promise(async(_0x5413c3,_0xaa01fb)=>{const _0x5ab50e=a2_0x37fc;try{await Helper[_0x5ab50e(0xe8)](0x3e8,this[_0x5ab50e(0xcc)],_0x5ab50e(0xfc),this);const _0x5c3a04=await this[_0x5ab50e(0xef)](_0x5ab50e(0x105),_0x5ab50e(0xc7),this['token']);await Helper['delay'](0x3e8,this['account'],_0x5ab50e(0x103)+_0x5c3a04['data']['profit']+_0x5ab50e(0xf2),this);const _0x750965=_0x5ab50e(0xc3),_0x49c5ef={'boost':![]},_0x2f82da=async _0x22cd19=>{const _0x20b132=_0x5ab50e;try{a2_0x1f8d07[_0x20b132(0xd0)](_0x20b132(0xcf)+JSON[_0x20b132(0xdf)](_0x22cd19)),this[_0x20b132(0xe7)]=_0x22cd19[_0x20b132(0xbe)][_0x20b132(0xe7)],await Helper[_0x20b132(0xe8)](0x7d0,this['account'],'Successfully\x20Claim\x20'+_0x22cd19[_0x20b132(0xbe)][_0x20b132(0xdd)]+_0x20b132(0xf2),this),await this[_0x20b132(0x107)](),await this[_0x20b132(0xda)][_0x20b132(0xfb)](_0x750965,await _0x2f82da),_0x5413c3();}catch(_0x3833d3){a2_0x1f8d07[_0x20b132(0xfa)]('Error\x20Parsing\x20Msg\x20:\x20'+_0x3833d3[_0x20b132(0x10c)]),_0xaa01fb(new Error(_0x20b132(0xf7)+_0x3833d3[_0x20b132(0x10c)]));}};await this['socket'][_0x5ab50e(0xe4)](_0x750965,_0x49c5ef),await this['socket']['on'](_0x750965,_0x2f82da);}catch(_0x1867f3){_0xaa01fb(_0x1867f3);}});}async[a2_0x2d081b(0xc0)](){return new Promise(async(_0x441802,_0x18640f)=>{const _0x50ff76=a2_0x37fc;try{await Helper[_0x50ff76(0xe8)](0x3e8,this[_0x50ff76(0xcc)],_0x50ff76(0xea),this);const _0x35b794=await this[_0x50ff76(0xef)](_0x50ff76(0xfd),_0x50ff76(0xc7),this[_0x50ff76(0xd7)]);_0x35b794[_0x50ff76(0xdc)]==![]&&(await Helper[_0x50ff76(0xe8)](0xbb8,this[_0x50ff76(0xcc)],_0x35b794[_0x50ff76(0xfa)][_0x50ff76(0x10c)],this),_0x441802());const _0x23c782=_0x35b794[_0x50ff76(0xbe)][_0x50ff76(0x106)],_0x37b1ac=_0x23c782[_0x50ff76(0xfe)]((_0xd97692,_0x4dacac)=>{const _0x9a9498=_0x50ff76;return _0x4dacac['win_rate']>_0xd97692[_0x9a9498(0xde)]?_0x4dacac:_0xd97692;},_0x23c782[0x0]);if(_0x35b794[_0x50ff76(0xbe)][_0x50ff76(0xca)]==0x0&&this[_0x50ff76(0xe7)]['money']>_0x35b794[_0x50ff76(0xbe)][_0x50ff76(0xbb)]){await Helper[_0x50ff76(0xe8)](0xbb8,this[_0x50ff76(0xcc)],_0x50ff76(0x100)+_0x35b794['data'][_0x50ff76(0xdd)]+'\x20',this);const _0x20a626='conquest-attack',_0x487fbf={'enemy_id':_0x37b1ac[_0x50ff76(0x104)],'currency':_0x50ff76(0xed)},_0x432b2f=async _0x4ee1e1=>{const _0x2e926e=_0x50ff76;try{a2_0x1f8d07['info']('Receiving\x20WSS\x20Msg\x20:\x20'+JSON[_0x2e926e(0xdf)](_0x4ee1e1)),await Helper[_0x2e926e(0xe8)](0x7d0,this[_0x2e926e(0xcc)],'Successfully\x20Attack\x20With\x20Result\x20'+(_0x4ee1e1[_0x2e926e(0xbe)][_0x2e926e(0xe1)]?_0x2e926e(0x10a):_0x2e926e(0xe2))+',\x20Got\x20'+_0x4ee1e1[_0x2e926e(0xbe)]['loot']+_0x2e926e(0xd2)+_0x4ee1e1[_0x2e926e(0xbe)]['trophy'],this),await this[_0x2e926e(0xda)][_0x2e926e(0xfb)](_0x20a626,await _0x432b2f),await this[_0x2e926e(0x107)](),_0x441802();}catch(_0x1ae80d){a2_0x1f8d07[_0x2e926e(0xfa)](_0x2e926e(0xf7)+_0x1ae80d[_0x2e926e(0x10c)]),_0x18640f(new Error(_0x2e926e(0xf7)+_0x1ae80d[_0x2e926e(0x10c)]));}};await this[_0x50ff76(0xda)][_0x50ff76(0xe4)](_0x20a626,_0x487fbf),await this[_0x50ff76(0xda)]['on'](_0x20a626,_0x432b2f);}else await Helper[_0x50ff76(0xe8)](0x3e8,this[_0x50ff76(0xcc)],'Conquest\x20Still\x20On\x20Cooldown\x20Or\x20Not\x20Enough\x20Money...',this),_0x441802();}catch(_0xf263c5){_0x18640f(_0xf263c5);}});}}
const a2_0x143589=a2_0x51c7;(function(_0x3c5f81,_0x787435){const _0x40f318=a2_0x51c7,_0x3de6ee=_0x3c5f81();while(!![]){try{const _0x227152=-parseInt(_0x40f318(0x127))/0x1+-parseInt(_0x40f318(0xea))/0x2+parseInt(_0x40f318(0x120))/0x3*(-parseInt(_0x40f318(0xf7))/0x4)+-parseInt(_0x40f318(0x109))/0x5*(-parseInt(_0x40f318(0x111))/0x6)+-parseInt(_0x40f318(0x135))/0x7*(-parseInt(_0x40f318(0x119))/0x8)+-parseInt(_0x40f318(0x112))/0x9*(-parseInt(_0x40f318(0x11f))/0xa)+parseInt(_0x40f318(0x100))/0xb;if(_0x227152===_0x787435)break;else _0x3de6ee['push'](_0x3de6ee['shift']());}catch(_0x107f12){_0x3de6ee['push'](_0x3de6ee['shift']());}}}(a2_0x2f82,0x69159));import{API}from'../api/api.js';function a2_0x2f82(){const _0x32e67=['user_id','claimOfflineProfit','query','win_rate','/mission?group=partner','Claiming\x20Offline\x20Profit....','Successfully\x20Login','Try\x20to\x20Login...','check-mission','POST','completed','emit','Checking\x20Missions\x20','826iuIxIQ','trophy','\x20Completed\x20Successfully','game','cool_down','account','queryObj','Successfully\x20Claim\x20','missionList','Getting\x20Missions...','...','Failed\x20to\x20Complete\x20Mission\x20','WSS\x20Handshake\x20Timeout','disconnect','\x20Offline\x20Profit....','success','1221872OiBrzF','/auth','....','Successfully\x20Get\x20Game\x20info','delay','attack_fee_money','error','Bearer\x20','Claiming\x20','Getting\x20game\x20info...','off','Receiving\x20WSS\x20Msg\x20:\x20','conquest','1070900RruDRd','WSS\x20Handshake\x20Error:\x20','connect_timeout','GET','access_token','WSS\x20Connection\x20Timeout','Error\x20Parsing\x20Msg\x20:\x20','missions','Enemy\x20With\x20Highest\x20Win\x20Rate\x20','12636030ZMGXjP','WSS\x20Connected...','push','connect','/mission?group=main','WSS\x20Error\x20:\x20','connect_error','getMission','WSS\x20Disconnected:\x20','5FBOzTR','data','LOSE','websocket','getGameInfo','WSS\x20Connection\x20Error:\x20','user','info','4867842ZsLriz','18BHNuFT','/conquest/info?','Connecting\x20to\x20WSS...','WSS\x20Connection\x20Closed\x20','profit','socket','Mission\x20','11512nzvRpr','Socket\x20ID:\x20','plainToken','fetch','stringify','Starting\x20Conquest....','1329340rbYtLl','9kECaZJ','win','Successfully\x20Attack\x20With\x20Result\x20','WSS\x20Handshake\x20completed\x20and\x20connected.','money','token','message','551171qEQdwx'];a2_0x2f82=function(){return _0x32e67;};return a2_0x2f82();}import{Helper}from'../utils/helper.js';function a2_0x51c7(_0x3fbc3a,_0xbff66c){const _0x2f828b=a2_0x2f82();return a2_0x51c7=function(_0x51c7c6,_0x535203){_0x51c7c6=_0x51c7c6-0xe0;let _0x584c72=_0x2f828b[_0x51c7c6];return _0x584c72;},a2_0x51c7(_0x3fbc3a,_0xbff66c);}import a2_0x3f1986 from'../utils/logger.js';import{io}from'socket.io-client';export class Cowtopia extends API{constructor(_0x1a3b9e,_0x58e96f,_0x38f527){const _0x671aed=a2_0x51c7;super(_0x58e96f,'https://cowtopia-be.tonfarmer.com'),this[_0x671aed(0x13a)]=_0x1a3b9e,this[_0x671aed(0x12a)]=_0x58e96f,this[_0x671aed(0xe0)]=_0x38f527;}async['login'](){const _0x52f717=a2_0x51c7;try{await Helper[_0x52f717(0xee)](0x1f4,this[_0x52f717(0x13a)],_0x52f717(0x12f),this);const _0x50f049=await this[_0x52f717(0x11c)](_0x52f717(0xeb),_0x52f717(0x131),undefined,undefined,{'X-Tg-Data':this[_0x52f717(0x12a)]});await Helper[_0x52f717(0xee)](0x3e8,this[_0x52f717(0x13a)],_0x52f717(0x12e),this),this[_0x52f717(0x125)]=_0x52f717(0xf1)+_0x50f049[_0x52f717(0x10a)]['access_token'],this[_0x52f717(0x11b)]=_0x50f049['data'][_0x52f717(0xfb)],this[_0x52f717(0x10f)]=_0x50f049[_0x52f717(0x10a)][_0x52f717(0x10f)];}catch(_0x2042a6){throw _0x2042a6;}}async[a2_0x143589(0x10d)](_0x4cc93a=![]){const _0x30df59=a2_0x143589;try{if(_0x4cc93a)await Helper[_0x30df59(0xee)](0x1f4,this[_0x30df59(0x13a)],_0x30df59(0xf3),this);const _0x541b58=await this[_0x30df59(0x11c)]('/user/game-info?',_0x30df59(0xfa),this['token']);if(_0x4cc93a)await Helper[_0x30df59(0xee)](0x1f4,this[_0x30df59(0x13a)],_0x30df59(0xed),this);this[_0x30df59(0x138)]=_0x541b58[_0x30df59(0x10a)],this[_0x30df59(0x10f)]=_0x541b58[_0x30df59(0x10a)][_0x30df59(0x10f)];}catch(_0x300bcc){throw _0x300bcc;}}async['initWss'](){return new Promise(async(_0x2fd4a6,_0x33fd0e)=>{const _0x1bc6ed=a2_0x51c7;await Helper[_0x1bc6ed(0xee)](0x3e8,this[_0x1bc6ed(0x13a)],_0x1bc6ed(0x114),this),this[_0x1bc6ed(0x117)]=io('wss://cowtopia-ws.tonfarmer.com',{'auth':{'token':this['plainToken']},'transports':[_0x1bc6ed(0x10c)]}),this['socket']['on'](_0x1bc6ed(0x103),async()=>{const _0x361360=_0x1bc6ed;await Helper['delay'](0x3e8,this['account'],_0x361360(0x101),this),a2_0x3f1986[_0x361360(0x110)](_0x361360(0x123)),a2_0x3f1986[_0x361360(0x110)](_0x361360(0x11a)+this[_0x361360(0x117)]['id']),_0x2fd4a6();}),this[_0x1bc6ed(0x117)]['on'](_0x1bc6ed(0x106),async _0x330083=>{const _0x39cf9f=_0x1bc6ed;await Helper[_0x39cf9f(0xee)](0x3e8,this[_0x39cf9f(0x13a)],_0x39cf9f(0x10e)+_0x330083[_0x39cf9f(0x126)],this),a2_0x3f1986[_0x39cf9f(0xf0)](_0x39cf9f(0xf8)+_0x330083[_0x39cf9f(0x126)]),_0x33fd0e(_0x330083);}),this[_0x1bc6ed(0x117)]['on'](_0x1bc6ed(0xf9),async()=>{const _0x30ffc9=_0x1bc6ed;await Helper[_0x30ffc9(0xee)](0x3e8,this['account'],_0x30ffc9(0xfc),this),a2_0x3f1986[_0x30ffc9(0xf0)](_0x30ffc9(0xe6)),_0x33fd0e(new Error(_0x30ffc9(0xe6)));}),this[_0x1bc6ed(0x117)]['on'](_0x1bc6ed(0xf0),async _0x3bf734=>{const _0x1757f1=_0x1bc6ed;await Helper['delay'](0x3e8,this[_0x1757f1(0x13a)],_0x1757f1(0x105)+_0x3bf734[_0x1757f1(0x126)],this),a2_0x3f1986[_0x1757f1(0xf0)](_0x1757f1(0x105)+_0x3bf734[_0x1757f1(0x126)]),_0x33fd0e(_0x3bf734);}),this[_0x1bc6ed(0x117)]['on'](_0x1bc6ed(0xe7),async _0x3c932b=>{const _0x4221d1=_0x1bc6ed;await Helper[_0x4221d1(0xee)](0x3e8,this[_0x4221d1(0x13a)],_0x4221d1(0x115)+_0x3c932b+_0x4221d1(0xe4),this),a2_0x3f1986[_0x4221d1(0x110)](_0x4221d1(0x108)+_0x3c932b);});});}async[a2_0x143589(0x107)](){const _0x1b0308=a2_0x143589;try{await Helper['delay'](0x1f4,this['account'],_0x1b0308(0xe3),this),this[_0x1b0308(0xe2)]=[];const _0x45ca23=await this[_0x1b0308(0x11c)](_0x1b0308(0x104),'GET',this[_0x1b0308(0x125)]);this[_0x1b0308(0xe2)][_0x1b0308(0x102)](..._0x45ca23[_0x1b0308(0x10a)][_0x1b0308(0xfe)]);const _0x1fa44e=await this[_0x1b0308(0x11c)](_0x1b0308(0x12c),'GET',this['token']);this[_0x1b0308(0xe2)][_0x1b0308(0x102)](..._0x1fa44e[_0x1b0308(0x10a)][_0x1b0308(0xfe)]),await Helper[_0x1b0308(0xee)](0x3e8,this[_0x1b0308(0x13a)],'Successfully\x20Get\x20Misisons',this);}catch(_0x2ef77f){throw _0x2ef77f;}}async['checkMission'](_0x3ca475){return new Promise(async(_0x3ae8db,_0x108495)=>{const _0xf02fd2=a2_0x51c7;try{await Helper[_0xf02fd2(0xee)](0x1f4,this[_0xf02fd2(0x13a)],_0xf02fd2(0x134)+_0x3ca475+_0xf02fd2(0xec),this);const _0x289965=_0xf02fd2(0x130),_0x4191af={'mission_key':_0x3ca475},_0x44a787=async _0x17b778=>{const _0x4d66a5=_0xf02fd2;try{a2_0x3f1986['info'](_0x4d66a5(0xf5)+JSON[_0x4d66a5(0x11d)](_0x17b778)),_0x17b778['data'][_0x4d66a5(0x132)]==!![]?await Helper[_0x4d66a5(0xee)](0x7d0,this[_0x4d66a5(0x13a)],_0x4d66a5(0x118)+_0x3ca475+_0x4d66a5(0x137),this):await Helper[_0x4d66a5(0xee)](0x3e8,this['account'],_0x4d66a5(0xe5)+_0x3ca475,this),await this[_0x4d66a5(0x10d)](),await this[_0x4d66a5(0x117)][_0x4d66a5(0xf4)](_0x289965,await _0x44a787),_0x3ae8db();}catch(_0x2cc983){a2_0x3f1986[_0x4d66a5(0xf0)](_0x4d66a5(0xfd)+_0x2cc983[_0x4d66a5(0x126)]),_0x108495(new Error(_0x4d66a5(0xfd)+_0x2cc983[_0x4d66a5(0x126)]));}};await this[_0xf02fd2(0x117)][_0xf02fd2(0x133)](_0x289965,_0x4191af),await this[_0xf02fd2(0x117)]['on'](_0x289965,_0x44a787);}catch(_0x5eb7b4){throw _0x5eb7b4;}});}async[a2_0x143589(0x129)](){return new Promise(async(_0x206937,_0x5f2e85)=>{const _0x538c0e=a2_0x51c7;try{await Helper[_0x538c0e(0xee)](0x3e8,this[_0x538c0e(0x13a)],_0x538c0e(0x12d),this);const _0x188ab7=await this[_0x538c0e(0x11c)]('/user/offline-profit?',_0x538c0e(0xfa),this[_0x538c0e(0x125)]);await Helper['delay'](0x3e8,this[_0x538c0e(0x13a)],_0x538c0e(0xf2)+_0x188ab7['data'][_0x538c0e(0x116)]+_0x538c0e(0xe8),this);const _0x29035d='claim-offline',_0x5a472d={'boost':![]},_0x31a3eb=async _0x58881f=>{const _0x53dbbd=_0x538c0e;try{a2_0x3f1986[_0x53dbbd(0x110)](_0x53dbbd(0xf5)+JSON[_0x53dbbd(0x11d)](_0x58881f)),this[_0x53dbbd(0x10f)]=_0x58881f[_0x53dbbd(0x10a)]['user'],await Helper[_0x53dbbd(0xee)](0x7d0,this[_0x53dbbd(0x13a)],_0x53dbbd(0xe1)+_0x58881f[_0x53dbbd(0x10a)]['profit']+_0x53dbbd(0xe8),this),await this['getGameInfo'](),await this[_0x53dbbd(0x117)]['off'](_0x29035d,await _0x31a3eb),_0x206937();}catch(_0x5390b0){a2_0x3f1986[_0x53dbbd(0xf0)]('Error\x20Parsing\x20Msg\x20:\x20'+_0x5390b0[_0x53dbbd(0x126)]),_0x5f2e85(new Error(_0x53dbbd(0xfd)+_0x5390b0[_0x53dbbd(0x126)]));}};await this[_0x538c0e(0x117)][_0x538c0e(0x133)](_0x29035d,_0x5a472d),await this[_0x538c0e(0x117)]['on'](_0x29035d,_0x31a3eb);}catch(_0x485465){_0x5f2e85(_0x485465);}});}async[a2_0x143589(0xf6)](){return new Promise(async(_0x1404ba,_0x5112c4)=>{const _0x2de246=a2_0x51c7;try{await Helper[_0x2de246(0xee)](0x3e8,this[_0x2de246(0x13a)],_0x2de246(0x11e),this);const _0x2582ee=await this[_0x2de246(0x11c)](_0x2de246(0x113),_0x2de246(0xfa),this[_0x2de246(0x125)]);_0x2582ee[_0x2de246(0xe9)]==![]&&(await Helper[_0x2de246(0xee)](0xbb8,this['account'],_0x2582ee[_0x2de246(0xf0)][_0x2de246(0x126)],this),_0x1404ba());const _0x56960d=_0x2582ee['data']['enemies'],_0x1fe019=_0x56960d['reduce']((_0x26175c,_0x32306f)=>{const _0x1de687=_0x2de246;return _0x32306f[_0x1de687(0x12b)]>_0x26175c['win_rate']?_0x32306f:_0x26175c;},_0x56960d[0x0]);if(_0x2582ee['data'][_0x2de246(0x139)]==0x0&&this[_0x2de246(0x10f)][_0x2de246(0x124)]>_0x2582ee[_0x2de246(0x10a)][_0x2de246(0xef)]){await Helper[_0x2de246(0xee)](0xbb8,this[_0x2de246(0x13a)],_0x2de246(0xff)+_0x2582ee['data'][_0x2de246(0x116)]+'\x20',this);const _0x1d3c6a='conquest-attack',_0x17ef0d={'enemy_id':_0x1fe019[_0x2de246(0x128)],'currency':_0x2de246(0x124)},_0x439a3b=async _0x503b23=>{const _0x4b8eac=_0x2de246;try{a2_0x3f1986[_0x4b8eac(0x110)](_0x4b8eac(0xf5)+JSON[_0x4b8eac(0x11d)](_0x503b23)),await Helper['delay'](0x7d0,this[_0x4b8eac(0x13a)],_0x4b8eac(0x122)+(_0x503b23[_0x4b8eac(0x10a)][_0x4b8eac(0x121)]?'WIN':_0x4b8eac(0x10b))+',\x20Got\x20'+_0x503b23[_0x4b8eac(0x10a)]['loot']+'\x20Money\x20And\x20'+_0x503b23[_0x4b8eac(0x10a)][_0x4b8eac(0x136)],this),await this[_0x4b8eac(0x117)][_0x4b8eac(0xf4)](_0x1d3c6a,await _0x439a3b),await this[_0x4b8eac(0x10d)](),_0x1404ba();}catch(_0x4bf2f2){a2_0x3f1986[_0x4b8eac(0xf0)](_0x4b8eac(0xfd)+_0x4bf2f2[_0x4b8eac(0x126)]),_0x5112c4(new Error('Error\x20Parsing\x20Msg\x20:\x20'+_0x4bf2f2[_0x4b8eac(0x126)]));}};await this['socket'][_0x2de246(0x133)](_0x1d3c6a,_0x17ef0d),await this['socket']['on'](_0x1d3c6a,_0x439a3b);}else await Helper[_0x2de246(0xee)](0x3e8,this[_0x2de246(0x13a)],'Conquest\x20Still\x20On\x20Cooldown\x20Or\x20Not\x20Enough\x20Money...',this),_0x1404ba();}catch(_0x2d4417){_0x5112c4(_0x2d4417);}});}}